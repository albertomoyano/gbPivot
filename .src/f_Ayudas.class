' Gambas class file

Public Sub CargarAyuda(sCampo As String)

  Dim hResult As Result
  Dim sQuery As String

  Print "Buscando ayuda para campo: " & sCampo  ' ← Para debug

  ' ' Consulta para obtener la ayuda del campo específico
  ' sQuery = "SELECT contenido FROM ayudas WHERE campo = ?"

  sQuery = "Select * from ayudas where campo = &1"

  Try hResult = m_OnOff_y_Red.meConn.Exec(sQuery)
  If Error Then
    Message.Error("Error al cargar ayuda: " & Error.Text)
    Return
  Endif

  If hResult.Available Then
    contenido.Text = hResult!contenido
    Me.Title = "Ayuda para: " & sCampo
  Else
    contenido.Text = "No hay ayuda disponible para este campo."
    Me.Title = "Ayuda para: " & sCampo
    Print "No se encontró ayuda para: " & sCampo  ' ← Para debug
  Endif

End
