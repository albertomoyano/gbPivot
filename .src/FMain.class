' Gambas class file

Private segundos As Integer
Private minutos As Integer
Private horas As Integer

Public Sub Form_Open()

  SplitterPanel3.Layout = [1, 1]
  SplitterPanel2.Layout = [7, 3]

  ' Inicializamos los contadores de minutos y segundos
  horas = 0
  minutos = 0
  segundos = 0
  ' Configuramos el Timer para que se ejecute cada segundo (1000 milisegundos)
  TimerParcial.Delay = 1000
  TimerParcial.Stop  ' No iniciamos el Timer hasta abrir un proyecto

End

Public Sub Menu5_Click()

  Quit

End

Public Sub SplitterPanel3_Resize()

  SplitterPanel3.Layout = [1, 1]

End

Public Sub SplitterPanel2_Resize()

  SplitterPanel2.Layout = [7, 3]

End

Public Sub Menu2_Click()

  f_Preferencias.ShowModal()

End

Public Sub Menu7_Click()

  f_Conversor.ShowModal()

End

Public Sub TimerParcial_Timer()

  ' Incrementamos los segundos
  segundos += 1

  ' Si los segundos llegan a 60, incrementamos los minutos y reiniciamos los segundos
  If segundos = 60 Then
    segundos = 0
    minutos += 1
  Endif

  ' Si los minutos llegan a 60, incrementamos las horas y reiniciamos los minutos
  If minutos = 60 Then
    minutos = 0
    horas += 1
  Endif

  ' Actualizamos el display del tiempo
  ActualizarDisplay

End

' Funci칩n para actualizar el display del tiempo
Public Sub ActualizarDisplay()

  txtTiempo.Caption = Right$("0" & horas, 2) & ":" & Right$("0" & minutos, 2) & ":" & Right$("0" & segundos, 2)

End

' Funci칩n para actualizar el display del bot칩n

Public Sub reinicamosTiempo()

  ' Reiniciamos el conteo de horas, minutos y segundos
  horas = 0
  minutos = 0
  segundos = 0

  ' Detenemos el Timer si est치 corriendo, luego lo reiniciamos
  TimerParcial.Stop
  TimerParcial.Start

  ' Actualizamos el display para reflejar el reinicio
  ActualizarDisplay

End
